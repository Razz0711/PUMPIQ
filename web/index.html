<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PumpIQ â€” AI-Powered Crypto Intelligence</title>
<style>
/* â”€â”€ CSS Reset & Variables â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
:root {
    --bg-primary: #0a0e17;
    --bg-secondary: #111827;
    --bg-card: #1a1f2e;
    --bg-card-hover: #212738;
    --border: #2a3042;
    --text-primary: #e5e7eb;
    --text-secondary: #9ca3af;
    --text-muted: #6b7280;
    --accent: #3b82f6;
    --accent-glow: rgba(59,130,246,0.15);
    --green: #10b981;
    --green-bg: rgba(16,185,129,0.1);
    --red: #ef4444;
    --red-bg: rgba(239,68,68,0.1);
    --yellow: #f59e0b;
    --purple: #8b5cf6;
    --cyan: #06b6d4;
    --gradient: linear-gradient(135deg, #3b82f6, #8b5cf6);
    --radius: 12px;
    --radius-sm: 8px;
    --shadow: 0 4px 24px rgba(0,0,0,0.3);
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg-primary);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
}
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }

/* â”€â”€ Scrollbar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
::-webkit-scrollbar { width:6px; }
::-webkit-scrollbar-track { background:var(--bg-primary); }
::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }

/* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.header {
    position: sticky; top:0; z-index:100;
    background: rgba(10,14,23,0.95);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    padding: 0 24px;
    height: 60px;
    display: flex; align-items:center; justify-content:space-between;
}
.logo {
    font-size:22px; font-weight:800;
    background: var(--gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    cursor: pointer;
}
.nav-tabs { display:flex; gap:4px; }
.nav-tab {
    padding: 8px 16px; border-radius:var(--radius-sm);
    color:var(--text-secondary); cursor:pointer;
    font-size:14px; font-weight:500; transition:all 0.2s;
    border: none; background: none;
}
.nav-tab:hover { color:var(--text-primary); background:var(--bg-card); }
.nav-tab.active {
    color:var(--accent); background:var(--accent-glow);
}
.header-right { display:flex; align-items:center; gap:12px; }
.search-box {
    padding: 8px 14px; border-radius:20px;
    background:var(--bg-card); border:1px solid var(--border);
    color:var(--text-primary); font-size:13px; width:220px;
    outline:none; transition:border 0.2s;
}
.search-box:focus { border-color:var(--accent); }
.btn {
    padding: 8px 18px; border-radius:var(--radius-sm);
    font-size:13px; font-weight:600; cursor:pointer;
    border:none; transition:all 0.2s;
}
.btn-primary {
    background:var(--gradient); color:#fff;
}
.btn-primary:hover { opacity:0.9; }
.btn-outline {
    background:transparent; color:var(--accent);
    border:1px solid var(--accent);
}
.btn-outline:hover { background:var(--accent-glow); }
.btn-green { background:var(--green); color:#fff; }
.btn-green:hover { opacity:0.9; }
.btn-sm { padding:6px 12px; font-size:12px; }
.btn-danger { background:var(--red); color:#fff; }

.user-badge {
    display:flex; align-items:center; gap:8px;
    padding:6px 12px; border-radius:20px;
    background:var(--bg-card); border:1px solid var(--border);
    color:var(--text-secondary); font-size:13px; cursor:pointer;
}
.user-avatar {
    width:28px; height:28px; border-radius:50%;
    background:var(--gradient); display:flex; align-items:center; justify-content:center;
    color:#fff; font-size:12px; font-weight:700;
}

/* â”€â”€ Page Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.page { display:none; padding:24px; max-width:1200px; margin:0 auto; }
.page.active { display:block; }

/* â”€â”€ Hero Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.hero {
    text-align:center; padding:60px 20px 40px;
}
.hero-tag {
    color:var(--cyan); font-size:13px; font-weight:700; letter-spacing:2px;
    text-transform:uppercase; margin-bottom:16px;
}
.hero-title {
    font-size:48px; font-weight:900; line-height:1.1; margin-bottom:16px;
    color:var(--text-primary);
}
.hero-desc {
    color:var(--text-secondary); font-size:16px; max-width:600px; margin:0 auto 40px;
    line-height:1.6;
}
.hero-steps {
    display:grid; grid-template-columns:repeat(3,1fr); gap:20px;
    max-width:900px; margin:0 auto;
}
.step-card {
    background:var(--bg-card); border:1px solid var(--border);
    border-radius:var(--radius); padding:24px;
    text-align:left; transition:border 0.2s;
}
.step-card:hover { border-color:var(--accent); }
.step-num {
    color:var(--cyan); font-size:12px; font-weight:700; margin-bottom:8px;
}
.step-title { font-size:18px; font-weight:700; margin-bottom:8px; }
.step-desc { color:var(--text-secondary); font-size:13px; line-height:1.5; }

/* â”€â”€ Section Titles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.section-title {
    font-size:24px; font-weight:800; margin-bottom:6px;
}
.section-desc {
    color:var(--text-secondary); font-size:14px; margin-bottom:20px;
}

/* â”€â”€ Cards Grid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.cards-grid {
    display:grid; grid-template-columns:repeat(auto-fill, minmax(280px,1fr));
    gap:16px;
}
.card {
    background:var(--bg-card); border:1px solid var(--border);
    border-radius:var(--radius); padding:20px;
    cursor:pointer; transition:all 0.2s;
}
.card:hover { background:var(--bg-card-hover); border-color:var(--accent); }

/* â”€â”€ Filter Tabs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.filter-bar {
    display:flex; gap:8px; margin-bottom:20px; flex-wrap:wrap; align-items:center;
}
.filter-pill {
    padding:6px 16px; border-radius:20px; font-size:13px;
    background:var(--bg-card); border:1px solid var(--border);
    color:var(--text-secondary); cursor:pointer; transition:all 0.2s;
}
.filter-pill:hover { color:var(--text-primary); border-color:var(--text-muted); }
.filter-pill.active { background:var(--accent); color:#fff; border-color:var(--accent); }

/* â”€â”€ Token Feed Table â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.feed-table { width:100%; border-collapse:collapse; }
.feed-table th {
    text-align:left; padding:12px 16px; font-size:12px;
    color:var(--text-muted); text-transform:uppercase; letter-spacing:0.5px;
    border-bottom:1px solid var(--border);
}
.feed-table td {
    padding:14px 16px; border-bottom:1px solid var(--border);
    font-size:14px; vertical-align:middle;
}
.feed-table tr:hover { background:var(--bg-card); }
.token-info { display:flex; align-items:center; gap:10px; }
.token-icon {
    width:36px; height:36px; border-radius:50%;
    background:var(--gradient); display:flex; align-items:center; justify-content:center;
    color:#fff; font-size:12px; font-weight:700; flex-shrink:0;
}
.token-name { font-weight:600; }
.token-symbol { color:var(--text-muted); font-size:12px; }
.price-positive { color:var(--green); }
.price-negative { color:var(--red); }

/* â”€â”€ AI Recs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.market-summary-box {
    background:var(--bg-card); border:1px solid var(--border);
    border-radius:var(--radius); padding:20px; margin-bottom:20px;
}
.market-summary-box h4 { font-size:14px; color:var(--text-muted); margin-bottom:8px; }
.market-summary-box p { color:var(--text-secondary); font-size:14px; line-height:1.6; }

.toggle-row { display:flex; gap:24px; margin-bottom:20px; }
.toggle-item {
    display:flex; align-items:center; gap:10px;
    background:var(--bg-card); border:1px solid var(--border);
    border-radius:var(--radius); padding:14px 20px; flex:1;
}
.toggle-switch {
    width:40px; height:22px; border-radius:11px;
    background:var(--cyan); position:relative; cursor:pointer; flex-shrink:0;
}
.toggle-switch::after {
    content:''; position:absolute; top:2px; left:2px;
    width:18px; height:18px; border-radius:50%; background:#fff;
    transition: left 0.2s;
}
.toggle-switch.off { background:var(--text-muted); }
.toggle-switch.off::after { left:2px; }
.toggle-switch:not(.off)::after { left:20px; }
.toggle-label { font-weight:600; font-size:14px; }
.toggle-desc { color:var(--text-muted); font-size:12px; }

.score-card {
    background:var(--bg-card); border:1px solid var(--border);
    border-radius:var(--radius); padding:20px; position:relative;
}
.score-circle {
    width:52px; height:52px; border-radius:50%;
    display:flex; align-items:center; justify-content:center;
    font-weight:800; font-size:18px; color:#fff;
    position:absolute; top:16px; right:16px;
}
.score-green { background:var(--green); }
.score-yellow { background:var(--yellow); }
.score-red { background:var(--red); }
.score-purple { background:var(--purple); }
.score-card-name { font-weight:700; font-size:16px; }
.score-card-sym { color:var(--text-muted); font-size:13px; margin-bottom:10px; }
.score-card-summary { color:var(--text-secondary); font-size:13px; line-height:1.5; margin-bottom:12px; }
.verdict-badge {
    display:inline-block; padding:4px 10px; border-radius:4px;
    font-size:12px; font-weight:700;
}
.verdict-STRONG_BUY, .verdict-BUY { background:var(--green-bg); color:var(--green); }
.verdict-HOLD { background:rgba(245,158,11,0.1); color:var(--yellow); }
.verdict-CAUTION { background:var(--red-bg); color:var(--red); }
.verdict-AVOID { background:var(--red-bg); color:var(--red); }

.on-chain-bars { margin-top:10px; }
.bar-row { display:flex; align-items:center; gap:8px; margin-bottom:4px; }
.bar-label { font-size:11px; color:var(--text-muted); width:80px; flex-shrink:0; }
.bar-track { flex:1; height:6px; background:var(--border); border-radius:3px; }
.bar-fill { height:100%; border-radius:3px; background:var(--cyan); }

/* â”€â”€ Leaderboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.lb-table { width:100%; border-collapse:collapse; }
.lb-table th {
    text-align:left; padding:12px 16px; font-size:12px;
    color:var(--text-muted); text-transform:uppercase;
    border-bottom:1px solid var(--border);
}
.lb-table td {
    padding:14px 16px; border-bottom:1px solid var(--border); font-size:14px;
}
.lb-table tr:hover { background:var(--bg-card); }
.trader-addr { color:var(--accent); font-family:monospace; font-size:13px; }

/* â”€â”€ Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal-overlay {
    display:none; position:fixed; inset:0;
    background:rgba(0,0,0,0.6); backdrop-filter:blur(4px);
    z-index:200; justify-content:center; align-items:flex-start;
    padding:40px 20px; overflow-y:auto;
}
.modal-overlay.active { display:flex; }
.modal {
    background:var(--bg-secondary); border:1px solid var(--border);
    border-radius:16px; width:100%; max-width:500px;
    padding:32px; position:relative;
    box-shadow:0 20px 60px rgba(0,0,0,0.5);
}
.modal-close {
    position:absolute; top:16px; right:16px;
    background:none; border:none; color:var(--text-muted);
    font-size:20px; cursor:pointer;
}
.modal h2 { font-size:22px; margin-bottom:20px; }
.form-group { margin-bottom:16px; }
.form-group label {
    display:block; font-size:13px; color:var(--text-secondary);
    margin-bottom:6px; font-weight:500;
}
.form-input {
    width:100%; padding:10px 14px; border-radius:var(--radius-sm);
    background:var(--bg-card); border:1px solid var(--border);
    color:var(--text-primary); font-size:14px; outline:none;
}
.form-input:focus { border-color:var(--accent); }
.form-error { color:var(--red); font-size:12px; margin-top:4px; display:none; }
.form-divider {
    text-align:center; color:var(--text-muted); font-size:13px;
    margin:16px 0; position:relative;
}
.form-divider::before, .form-divider::after {
    content:''; position:absolute; top:50%;
    width:calc(50% - 20px); height:1px; background:var(--border);
}
.form-divider::before { left:0; }
.form-divider::after { right:0; }

/* â”€â”€ Detail Modal (larger) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.modal-lg { max-width:720px; }
.detail-header { display:flex; align-items:center; gap:16px; margin-bottom:20px; }
.detail-avatar {
    width:48px; height:48px; border-radius:50%;
    background:var(--gradient); display:flex; align-items:center; justify-content:center;
    color:#fff; font-size:16px; font-weight:700;
}
.detail-name { font-size:20px; font-weight:700; }
.detail-symbol { color:var(--text-muted); font-size:13px; }
.detail-price-row { display:flex; align-items:center; gap:16px; margin-bottom:20px; }
.detail-price { font-size:28px; font-weight:800; }
.metrics-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-bottom:20px; }
.metric-box {
    background:var(--bg-card); border-radius:var(--radius-sm); padding:14px;
}
.metric-label { font-size:11px; color:var(--text-muted); margin-bottom:4px; }
.metric-value { font-size:15px; font-weight:600; }
.analysis-section {
    background:var(--bg-card); border-radius:var(--radius); padding:16px;
    margin-bottom:12px;
}
.analysis-title { font-size:14px; font-weight:700; margin-bottom:10px; }
.analysis-row {
    display:flex; justify-content:space-between; padding:4px 0;
    font-size:13px; color:var(--text-secondary);
}
.score-bar-container { height:6px; background:var(--border); border-radius:3px; margin-top:6px; }
.score-bar { height:100%; border-radius:3px; transition:width 0.5s; }
.score-bar.green { background:var(--green); }
.score-bar.yellow { background:var(--yellow); }
.score-bar.red { background:var(--red); }
.ai-box {
    background:var(--bg-card); border:1px solid var(--purple);
    border-radius:var(--radius); padding:16px; margin-top:12px;
}
.ai-box-title { font-size:14px; font-weight:700; margin-bottom:8px; }
.ai-badge {
    display:inline-block; padding:2px 8px; border-radius:4px;
    font-size:10px; font-weight:700; background:var(--purple); color:#fff;
    margin-left:8px;
}
.ai-text { color:var(--text-secondary); font-size:13px; line-height:1.6; }

/* â”€â”€ Wallet Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.wallet-card {
    background:var(--bg-card); border:1px solid var(--border);
    border-radius:var(--radius); padding:16px;
    display:flex; justify-content:space-between; align-items:center;
    margin-bottom:8px;
}
.wallet-addr { font-family:monospace; font-size:13px; color:var(--accent); }
.wallet-chain {
    font-size:11px; padding:2px 8px; border-radius:4px;
    background:var(--accent-glow); color:var(--accent); font-weight:600;
}

/* â”€â”€ Wallet Balance Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.balance-card {
    background: linear-gradient(135deg, #1a1040 0%, #0d2137 50%, #0a2a1a 100%);
    border: 1px solid #2a2a4a;
    border-radius: 16px; padding: 28px;
    margin-bottom: 24px; position: relative; overflow: hidden;
}
.balance-card::before {
    content: ''; position: absolute; top: -40px; right: -40px;
    width: 120px; height: 120px; border-radius: 50%;
    background: rgba(124,92,255,0.08);
}
.balance-label { font-size: 13px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; }
.balance-amount { font-size: 36px; font-weight: 700; color: #fff; margin-bottom: 16px; }
.balance-amount .currency { font-size: 20px; color: #7c5cff; margin-right: 4px; }
.balance-actions { display: flex; gap: 10px; }
.balance-actions .btn { flex: 1; padding: 10px; font-size: 13px; }

/* â”€â”€ Bank Account Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.bank-card {
    background: var(--bg-card); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 16px;
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 8px;
}
.bank-info { display: flex; align-items: center; gap: 12px; }
.bank-icon {
    width: 40px; height: 40px; border-radius: 10px;
    background: linear-gradient(135deg, #7c5cff, #00d4aa);
    display: flex; align-items: center; justify-content: center;
    font-size: 18px; font-weight: 700; color: #fff;
}
.bank-name { font-weight: 600; font-size: 14px; }
.bank-detail { font-size: 12px; color: var(--text-muted); margin-top: 2px; }
.bank-verified { color: #00d4aa; font-size: 11px; font-weight: 600; }

/* â”€â”€ Transaction List â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.txn-item {
    display: flex; justify-content: space-between; align-items: center;
    padding: 12px 0; border-bottom: 1px solid var(--border);
}
.txn-type { font-size: 12px; padding: 2px 8px; border-radius: 4px; font-weight: 600; }
.txn-deposit { background: #0a2a1a; color: #00d4aa; }
.txn-withdraw { background: #2a1a1a; color: #ff6b6b; }
.txn-amount { font-weight: 600; font-size: 14px; }

/* â”€â”€ Verification Steps â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.verify-steps { display: flex; gap: 8px; margin: 16px 0; }
.verify-step {
    flex: 1; text-align: center; padding: 10px 8px;
    border-radius: 8px; font-size: 11px; font-weight: 600;
    background: var(--bg-card); border: 1px solid var(--border); color: var(--text-muted);
}
.verify-step.active { border-color: #7c5cff; color: #7c5cff; background: rgba(124,92,255,0.08); }
.verify-step.done { border-color: #00d4aa; color: #00d4aa; background: rgba(0,212,170,0.08); }

/* â”€â”€ Portfolio â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.portfolio-table { width:100%; border-collapse:collapse; }
.portfolio-table th {
    text-align:left; padding:10px 14px; font-size:12px;
    color:var(--text-muted); text-transform:uppercase;
    border-bottom:1px solid var(--border);
}
.portfolio-table td {
    padding:12px 14px; border-bottom:1px solid var(--border); font-size:14px;
}

/* â”€â”€ Loader â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
.loader { display:flex; justify-content:center; padding:60px; }
.spinner {
    width:36px; height:36px; border:3px solid var(--border);
    border-top-color:var(--accent); border-radius:50%;
    animation:spin 0.8s linear infinite;
}
@keyframes spin { to { transform:rotate(360deg); } }

.empty-state { text-align:center; padding:60px 20px; color:var(--text-muted); }
.empty-state h3 { font-size:18px; margin-bottom:8px; color:var(--text-secondary); }

/* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
@media (max-width:768px) {
    .hero-steps { grid-template-columns:1fr; }
    .hero-title { font-size:32px; }
    .metrics-grid { grid-template-columns:1fr; }
    .toggle-row { flex-direction:column; }
    .nav-tabs { display:none; }
    .header { padding:0 12px; }
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- HEADER                                                     -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="header">
    <div class="logo" onclick="navigate('home')">PumpIQ</div>
    <div class="nav-tabs">
        <button class="nav-tab active" data-page="home">Home</button>
        <button class="nav-tab" data-page="feed">Token Feed</button>
        <button class="nav-tab" data-page="ai">AI Recs</button>
        <button class="nav-tab" data-page="leaderboard">Leaderboard</button>
        <button class="nav-tab" data-page="market">Market</button>
    </div>
    <div class="header-right">
        <input class="search-box" id="globalSearch" placeholder="Search tokens..." onkeydown="if(event.key==='Enter')doSearch()">
        <div id="authArea">
            <button class="btn btn-primary" onclick="showAuthModal('login')">Login</button>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- HOME PAGE                                                  -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page active" id="page-home">
    <div class="hero">
        <div class="hero-tag">AI-POWERED ANALYTICS</div>
        <h1 class="hero-title">See through the noise.</h1>
        <p class="hero-desc">
            PumpIQ scores every token across idea quality, on-chain health, and technical signals
            â€” so you can trade with signal, not hype.
        </p>
        <div class="hero-steps">
            <div class="step-card">
                <div class="step-num">01</div>
                <div class="step-title">Browse</div>
                <div class="step-desc">Live feed of all tokens on DexScreener with real-time data from Solana, Base, and more.</div>
            </div>
            <div class="step-card">
                <div class="step-num">02</div>
                <div class="step-title">Analyze</div>
                <div class="step-desc">AI evaluates on-chain health, holder behavior, technical indicators, and bonding curve math.</div>
            </div>
            <div class="step-card">
                <div class="step-num">03</div>
                <div class="step-title">Decide</div>
                <div class="step-desc">Get a PumpIQ Score (0-100), risk flags, and a one-line verdict for every token.</div>
            </div>
        </div>
    </div>

    <!-- Trending Pills -->
    <div style="margin-bottom:24px">
        <h3 style="font-size:16px;margin-bottom:12px;color:var(--text-secondary)">ğŸ”¥ Trending</h3>
        <div id="trendingBar" style="display:flex;gap:8px;flex-wrap:wrap"></div>
    </div>

    <!-- Quick Market Table -->
    <div class="section-title">Top Coins</div>
    <div class="section-desc">Live market data from CoinGecko</div>
    <div style="overflow-x:auto">
        <table class="feed-table" id="homeMarketTable">
            <thead><tr><th>#</th><th>Token</th><th>Price</th><th>24h</th><th>Market Cap</th><th>Volume</th></tr></thead>
            <tbody id="homeMarketBody"></tbody>
        </table>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TOKEN FEED PAGE                                            -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page-feed">
    <div class="section-title">Token Feed</div>
    <div class="section-desc" id="feedCount">Live tokens from DexScreener</div>

    <div class="filter-bar">
        <div class="filter-pill active" data-sort="volume" onclick="setFeedSort(this)">Volume</div>
        <div class="filter-pill" data-sort="newest" onclick="setFeedSort(this)">Newest</div>
        <div class="filter-pill" data-sort="price" onclick="setFeedSort(this)">Price</div>
        <div class="filter-pill" data-sort="trades" onclick="setFeedSort(this)">Trades</div>
        <div style="width:1px;height:24px;background:var(--border);margin:0 8px"></div>
        <div class="filter-pill active" data-status="all" onclick="setFeedStatus(this)">All</div>
        <div class="filter-pill" data-status="active" onclick="setFeedStatus(this)">Active</div>
        <div class="filter-pill" data-status="graduated" onclick="setFeedStatus(this)">Graduated</div>
        <div style="flex:1"></div>
        <input class="search-box" style="width:180px" placeholder="Search feed..." oninput="filterFeedLocal(this.value)">
    </div>

    <div style="overflow-x:auto">
        <table class="feed-table">
            <thead><tr><th>Token</th><th>Price</th><th>24h</th><th>Volume</th><th>Liquidity</th><th>Trades</th><th>Age</th></tr></thead>
            <tbody id="feedBody"></tbody>
        </table>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- AI RECOMMENDATIONS PAGE                                    -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page-ai">
    <div class="section-title">AI Recommendations</div>
    <div class="section-desc">Configure data sources and let AI find the best tokens right now.</div>

    <!-- CoinGecko Market Summary Mini -->
    <div class="market-summary-box" style="margin-bottom:16px">
        <h4>Global Market (CoinGecko)</h4>
        <p id="aiMarketGlobal">Loading market data...</p>
    </div>

    <!-- Toggles -->
    <div class="toggle-row">
        <div class="toggle-item">
            <div class="toggle-switch" id="toggleOnchain" onclick="toggleSwitch(this)"></div>
            <div>
                <div class="toggle-label">On-Chain</div>
                <div class="toggle-desc">Holders, volume, curve progress, creator activity</div>
            </div>
        </div>
        <div class="toggle-item">
            <div class="toggle-switch" id="toggleTechnical" onclick="toggleSwitch(this)"></div>
            <div>
                <div class="toggle-label">Technical</div>
                <div class="toggle-desc">Price momentum, trade velocity, trend direction</div>
            </div>
        </div>
    </div>

    <button class="btn btn-green" onclick="loadAIRecs()" style="margin-bottom:20px">Analyze</button>

    <div id="aiTimestamp" style="color:var(--text-muted);font-size:12px;margin-bottom:12px"></div>

    <!-- Market Summary -->
    <div class="market-summary-box" id="aiSummaryBox" style="display:none">
        <h4>Market Summary</h4>
        <p id="aiSummaryText"></p>
    </div>

    <!-- Scored Tokens -->
    <div class="cards-grid" id="aiCards"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- LEADERBOARD PAGE                                           -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page-leaderboard">
    <div class="section-title">Leaderboard</div>
    <div class="section-desc">Top traders by realized PnL on DexScreener</div>

    <div style="overflow-x:auto">
        <table class="lb-table">
            <thead><tr><th>#</th><th>Trader</th><th>PnL (USD)</th><th>Spent</th><th>Received</th><th>Trades</th><th>Win Rate</th></tr></thead>
            <tbody id="lbBody"></tbody>
        </table>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- MARKET PAGE (detailed CoinGecko)                           -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page-market">
    <div class="section-title">Market Overview</div>
    <div class="section-desc">Top coins by market cap â€” click any row for deep analysis</div>

    <div id="trendingMarket" style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:20px"></div>

    <div style="overflow-x:auto">
        <table class="feed-table">
            <thead><tr><th>#</th><th>Token</th><th>Price</th><th>24h</th><th>Market Cap</th><th>Volume 24h</th></tr></thead>
            <tbody id="marketBody"></tbody>
        </table>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- PROFILE PAGE (visible when logged in)                      -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page-profile">
    <div class="section-title" id="profileTitle">My Profile</div>
    <div class="section-desc" id="profileEmail"></div>

    <!-- Wallet Balance Card -->
    <div class="balance-card" style="margin-top:20px">
        <div class="balance-label">Wallet Balance</div>
        <div class="balance-amount"><span class="currency">â‚¹</span><span id="walletBalanceDisplay">0.00</span></div>
        <div class="balance-actions">
            <button class="btn btn-primary" onclick="showDepositModal()">+ Add Money</button>
            <button class="btn btn-outline" onclick="showWithdrawModal()">Withdraw</button>
            <button class="btn btn-outline" onclick="showTransactionsModal()">History</button>
        </div>
    </div>

    <!-- Bank Accounts -->
    <div style="margin-top:24px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <h3 style="font-size:18px">ğŸ¦ Linked Bank Accounts</h3>
            <button class="btn btn-outline btn-sm" onclick="showBankModal()">+ Add Bank</button>
        </div>
        <div id="bankList"></div>
    </div>

    <!-- Wallets -->
    <div style="margin-top:24px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <h3 style="font-size:18px">Connected Wallets</h3>
            <button class="btn btn-outline btn-sm" onclick="showWalletModal()">+ Add Wallet</button>
        </div>
        <div id="walletList"></div>
    </div>

    <!-- Portfolio -->
    <div style="margin-top:32px">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <h3 style="font-size:18px">Portfolio</h3>
            <button class="btn btn-outline btn-sm" onclick="showPortfolioModal()">+ Add Position</button>
        </div>
        <table class="portfolio-table">
            <thead><tr><th>Coin</th><th>Amount</th><th>Avg Price</th><th>Current</th><th>PnL</th></tr></thead>
            <tbody id="portfolioBody"></tbody>
        </table>
    </div>

    <!-- Watchlist -->
    <div style="margin-top:32px">
        <h3 style="font-size:18px;margin-bottom:12px">Watchlist</h3>
        <div id="watchlistArea"></div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- AUTH MODAL                                                 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="authModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('authModal')">&times;</button>
        <h2 id="authTitle">Login</h2>
        <div id="authError" class="form-error"></div>

        <div id="registerFields" style="display:none">
            <div class="form-group">
                <label>Username</label>
                <input class="form-input" id="regUsername" placeholder="Choose a username">
            </div>
        </div>
        <div class="form-group">
            <label>Email</label>
            <input class="form-input" id="authEmail" type="email" placeholder="you@example.com">
        </div>
        <div class="form-group">
            <label>Password</label>
            <input class="form-input" id="authPassword" type="password" placeholder="Min 6 characters">
        </div>
        <button class="btn btn-primary" style="width:100%;margin-top:8px" id="authSubmitBtn" onclick="submitAuth()">Login</button>

        <p id="forgotPassLink" style="text-align:right;margin-top:8px;font-size:13px;">
            <a href="#" style="color:#7c5cff" onclick="showForgotPassword(event)">Forgot password?</a>
        </p>

        <div class="form-divider">or</div>
        <p style="text-align:center;font-size:13px;color:var(--text-secondary)">
            <span id="authToggleText">Don't have an account?</span>
            <a href="#" id="authToggleLink" onclick="toggleAuthMode(event)">Register</a>
        </p>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- FORGOT PASSWORD MODAL                                      -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="forgotModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('forgotModal')">&times;</button>
        <h2>Reset Password</h2>
        <p style="color:var(--text-secondary);font-size:13px;margin-bottom:16px;">Enter your email and we'll send you a reset link.</p>
        <div id="forgotError" class="form-error"></div>
        <div id="forgotSuccess" style="display:none;color:#00d4aa;background:#0a2a1a;padding:12px;border-radius:8px;margin-bottom:12px;"></div>
        <div class="form-group">
            <label>Email</label>
            <input class="form-input" id="forgotEmail" type="email" placeholder="you@example.com">
        </div>
        <button class="btn btn-primary" style="width:100%;" onclick="submitForgotPassword()">Send Reset Link</button>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- WALLET ADD MODAL                                           -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="walletModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('walletModal')">&times;</button>
        <h2>Connect Wallet</h2>
        <div class="form-group">
            <label>Wallet Address</label>
            <input class="form-input" id="walletAddr" placeholder="0x... or SOL address">
        </div>
        <div class="form-group">
            <label>Chain</label>
            <select class="form-input" id="walletChain">
                <option value="ethereum">Ethereum</option>
                <option value="solana">Solana</option>
                <option value="base">Base</option>
                <option value="polygon">Polygon</option>
                <option value="bsc">BSC</option>
            </select>
        </div>
        <div class="form-group">
            <label>Label (optional)</label>
            <input class="form-input" id="walletLabel" placeholder="e.g. My MetaMask">
        </div>
        <button class="btn btn-primary" style="width:100%;margin-top:8px" onclick="addWallet()">Add Wallet</button>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ADD BANK ACCOUNT MODAL                                     -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="bankModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('bankModal')">&times;</button>
        <h2>ğŸ¦ Link Bank Account</h2>
        <p style="color:var(--text-secondary);font-size:13px;margin-bottom:16px;">Your bank details are verified instantly and stored securely.</p>

        <div class="verify-steps" id="bankSteps">
            <div class="verify-step active" id="bankStep1">1. Enter Details</div>
            <div class="verify-step" id="bankStep2">2. Verify</div>
            <div class="verify-step" id="bankStep3">3. Linked âœ“</div>
        </div>

        <div id="bankError" class="form-error"></div>
        <div id="bankSuccess" style="display:none;color:#00d4aa;background:#0a2a1a;padding:12px;border-radius:8px;margin-bottom:12px;"></div>

        <div id="bankFormFields">
            <div class="form-group">
                <label>Account Holder Name</label>
                <input class="form-input" id="bankHolder" placeholder="As on bank passbook">
            </div>
            <div class="form-group">
                <label>Account Number</label>
                <input class="form-input" id="bankAccNum" placeholder="9-18 digit account number" maxlength="18">
            </div>
            <div class="form-group">
                <label>Confirm Account Number</label>
                <input class="form-input" id="bankAccNumConfirm" placeholder="Re-enter account number" maxlength="18">
            </div>
            <div class="form-group">
                <label>IFSC Code</label>
                <input class="form-input" id="bankIFSC" placeholder="e.g. SBIN0001234" maxlength="11" style="text-transform:uppercase">
            </div>
            <div class="form-group">
                <label>Bank Name</label>
                <input class="form-input" id="bankName" placeholder="e.g. State Bank of India">
            </div>
            <button class="btn btn-primary" style="width:100%;margin-top:8px" onclick="verifyAndAddBank()">Verify & Link Account</button>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- DEPOSIT MODAL                                              -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="depositModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('depositModal')">&times;</button>
        <h2>ğŸ’° Add Money to Wallet</h2>
        <div id="depositError" class="form-error"></div>
        <div id="depositSuccess" style="display:none;color:#00d4aa;background:#0a2a1a;padding:12px;border-radius:8px;margin-bottom:12px;"></div>

        <div id="depositNoBanks" style="display:none;text-align:center;padding:20px;color:var(--text-muted);">
            <p>No bank account linked yet.</p>
            <button class="btn btn-primary" style="margin-top:12px" onclick="closeModal('depositModal');showBankModal()">Link Bank Account</button>
        </div>

        <div id="depositFields">
            <div class="form-group">
                <label>Select Bank Account</label>
                <select class="form-input" id="depositBank"></select>
            </div>
            <div class="form-group">
                <label>Amount (â‚¹)</label>
                <input class="form-input" id="depositAmount" type="number" min="1" step="any" placeholder="Enter amount">
            </div>
            <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
                <button class="btn btn-outline btn-sm" onclick="setDepositAmount(500)">â‚¹500</button>
                <button class="btn btn-outline btn-sm" onclick="setDepositAmount(1000)">â‚¹1,000</button>
                <button class="btn btn-outline btn-sm" onclick="setDepositAmount(5000)">â‚¹5,000</button>
                <button class="btn btn-outline btn-sm" onclick="setDepositAmount(10000)">â‚¹10,000</button>
                <button class="btn btn-outline btn-sm" onclick="setDepositAmount(50000)">â‚¹50,000</button>
            </div>
            <button class="btn btn-primary" style="width:100%" onclick="submitDeposit()">Deposit</button>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- WITHDRAW MODAL                                             -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="withdrawModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('withdrawModal')">&times;</button>
        <h2>ğŸ“¤ Withdraw to Bank</h2>
        <p style="color:var(--text-secondary);font-size:13px;margin-bottom:12px;">Available: <strong>â‚¹<span id="withdrawAvailable">0.00</span></strong></p>
        <div id="withdrawError" class="form-error"></div>
        <div id="withdrawSuccess" style="display:none;color:#00d4aa;background:#0a2a1a;padding:12px;border-radius:8px;margin-bottom:12px;"></div>

        <div id="withdrawFields">
            <div class="form-group">
                <label>Select Bank Account</label>
                <select class="form-input" id="withdrawBank"></select>
            </div>
            <div class="form-group">
                <label>Amount (â‚¹)</label>
                <input class="form-input" id="withdrawAmount" type="number" min="1" step="any" placeholder="Enter amount">
            </div>
            <button class="btn btn-primary" style="width:100%" onclick="submitWithdraw()">Withdraw</button>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TRANSACTIONS MODAL                                         -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="transactionsModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('transactionsModal')">&times;</button>
        <h2>ğŸ“‹ Transaction History</h2>
        <div id="transactionsList" style="max-height:400px;overflow-y:auto;"></div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- PORTFOLIO ADD MODAL                                        -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="portfolioModal">
    <div class="modal">
        <button class="modal-close" onclick="closeModal('portfolioModal')">&times;</button>
        <h2>Add Position</h2>
        <div class="form-group">
            <label>Coin ID (e.g. bitcoin, solana)</label>
            <input class="form-input" id="pfCoinId" placeholder="bitcoin">
        </div>
        <div class="form-group">
            <label>Amount</label>
            <input class="form-input" id="pfAmount" type="number" step="any" placeholder="0.5">
        </div>
        <div class="form-group">
            <label>Avg Buy Price ($)</label>
            <input class="form-input" id="pfPrice" type="number" step="any" placeholder="65000">
        </div>
        <button class="btn btn-primary" style="width:100%;margin-top:8px" onclick="addPortfolioItem()">Add Position</button>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- TOKEN DETAIL MODAL                                         -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="detailModal">
    <div class="modal modal-lg">
        <button class="modal-close" onclick="closeModal('detailModal')">&times;</button>
        <div id="detailContent"><div class="loader"><div class="spinner"></div></div></div>
    </div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- JAVASCRIPT                                                 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentUser = null;
let authToken = localStorage.getItem('pumpiq_token') || null;
let currentPage = 'home';
let feedSort = 'volume';
let feedStatus = 'all';
let feedData = [];

const API = '';

async function api(path, opts = {}) {
    const headers = { 'Content-Type': 'application/json', ...(opts.headers || {}) };
    if (authToken) headers['Authorization'] = 'Bearer ' + authToken;
    const resp = await fetch(API + path, { ...opts, headers });
    if (!resp.ok) {
        const err = await resp.json().catch(() => ({}));
        throw new Error(err.detail || resp.statusText);
    }
    return resp.json();
}

function fmt(n) {
    if (n == null || isNaN(n)) return '-';
    if (n >= 1e9) return '$' + (n/1e9).toFixed(2) + 'B';
    if (n >= 1e6) return '$' + (n/1e6).toFixed(2) + 'M';
    if (n >= 1e3) return '$' + (n/1e3).toFixed(2) + 'K';
    if (n >= 1) return '$' + n.toFixed(2);
    if (n >= 0.001) return '$' + n.toFixed(4);
    return '$' + n.toFixed(8);
}

function fmtPct(n) {
    if (n == null) return '-';
    const cls = n >= 0 ? 'price-positive' : 'price-negative';
    const arrow = n >= 0 ? 'â–²' : 'â–¼';
    return `<span class="${cls}">${arrow} ${Math.abs(n).toFixed(2)}%</span>`;
}

function scoreColor(s) {
    if (s >= 7) return 'green'; if (s >= 4) return 'yellow'; return 'red';
}

// â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.querySelectorAll('.nav-tab').forEach(tab => {
    tab.addEventListener('click', () => navigate(tab.dataset.page));
});

function navigate(page) {
    if (page === 'profile' && !currentUser) {
        showAuthModal('login');
        return;
    }
    currentPage = page;
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById('page-' + page)?.classList.add('active');
    document.querySelectorAll('.nav-tab').forEach(t => {
        t.classList.toggle('active', t.dataset.page === page);
    });

    // Load data for page
    if (page === 'home') { loadHomeData(); }
    else if (page === 'feed') { loadFeed(); }
    else if (page === 'ai') { loadAIGlobal(); }
    else if (page === 'leaderboard') { loadLeaderboard(); }
    else if (page === 'market') { loadMarket(); }
    else if (page === 'profile') { loadProfile(); }
}

// â”€â”€ Auth â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let authMode = 'login';

function showAuthModal(mode) {
    authMode = mode;
    document.getElementById('authTitle').textContent = mode === 'login' ? 'Login' : 'Create Account';
    document.getElementById('authSubmitBtn').textContent = mode === 'login' ? 'Login' : 'Register';
    document.getElementById('registerFields').style.display = mode === 'register' ? 'block' : 'none';
    document.getElementById('forgotPassLink').style.display = mode === 'login' ? 'block' : 'none';
    document.getElementById('authToggleText').textContent = mode === 'login' ? "Don't have an account?" : "Already have an account?";
    document.getElementById('authToggleLink').textContent = mode === 'login' ? 'Register' : 'Login';
    document.getElementById('authError').style.display = 'none';
    document.getElementById('authModal').classList.add('active');
}

function toggleAuthMode(e) {
    e.preventDefault();
    showAuthModal(authMode === 'login' ? 'register' : 'login');
}

async function submitAuth() {
    const email = document.getElementById('authEmail').value;
    const password = document.getElementById('authPassword').value;
    const errEl = document.getElementById('authError');

    try {
        let data;
        if (authMode === 'login') {
            data = await api('/api/auth/login', {
                method: 'POST',
                body: JSON.stringify({ email, password }),
            });
        } else {
            const username = document.getElementById('regUsername').value;
            data = await api('/api/auth/register', {
                method: 'POST',
                body: JSON.stringify({ email, password, username }),
            });
        }

        authToken = data.access_token;
        localStorage.setItem('pumpiq_token', authToken);
        currentUser = data.user;
        updateAuthUI();
        closeModal('authModal');
    } catch (e) {
        errEl.style.color = '#ff4d4d';
        errEl.textContent = e.message;
        errEl.style.display = 'block';
    }
}

// â”€â”€ Forgot Password â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showForgotPassword(e) {
    e.preventDefault();
    closeModal('authModal');
    document.getElementById('forgotError').style.display = 'none';
    document.getElementById('forgotSuccess').style.display = 'none';
    document.getElementById('forgotEmail').value = document.getElementById('authEmail').value || '';
    document.getElementById('forgotModal').classList.add('active');
}

async function submitForgotPassword() {
    const email = document.getElementById('forgotEmail').value;
    const errEl = document.getElementById('forgotError');
    const succEl = document.getElementById('forgotSuccess');
    errEl.style.display = 'none';
    succEl.style.display = 'none';

    if (!email) { errEl.textContent = 'Please enter your email'; errEl.style.display = 'block'; return; }

    try {
        const data = await api('/api/auth/forgot-password', {
            method: 'POST',
            body: JSON.stringify({ email }),
        });
        succEl.textContent = data.message;
        succEl.style.display = 'block';
    } catch (e) {
        errEl.textContent = e.message;
        errEl.style.display = 'block';
    }
}

// â”€â”€ Resend Verification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function resendVerification() {
    try {
        const data = await api('/api/auth/resend-verification', { method: 'POST' });
        alert(data.message || 'Verification email sent!');
    } catch (e) {
        alert(e.message || 'Failed to send verification email');
    }
}

async function resendVerificationFromLogin(email) {
    const errEl = document.getElementById('authError');
    try {
        const data = await api('/api/auth/resend-verification-by-email', {
            method: 'POST',
            body: JSON.stringify({ email }),
        });
        errEl.style.color = '#00d4aa';
        errEl.innerHTML = data.message || 'Verification email sent! Check your inbox.';
    } catch (e) {
        errEl.innerHTML = e.message || 'Failed to resend';
    }
}

function logout() {
    authToken = null;
    currentUser = null;
    localStorage.removeItem('pumpiq_token');
    updateAuthUI();
    navigate('home');
}

function updateAuthUI() {
    const area = document.getElementById('authArea');
    if (currentUser) {
        const initials = (currentUser.username || currentUser.email).slice(0, 2).toUpperCase();
        area.innerHTML = `
            <div class="user-badge" onclick="navigate('profile')">
                <div class="user-avatar">${initials}</div>
                <span>${currentUser.username || currentUser.email}</span>
            </div>
            <button class="btn btn-sm btn-outline" onclick="logout()">Logout</button>
        `;
    } else {
        area.innerHTML = '<button class="btn btn-primary" onclick="showAuthModal(\'login\')">Login</button>';
    }
}

async function checkAuth() {
    if (!authToken) return;
    try {
        currentUser = await api('/api/auth/me');
        updateAuthUI();
    } catch {
        authToken = null;
        localStorage.removeItem('pumpiq_token');
    }
}

// â”€â”€ Modals â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function closeModal(id) {
    document.getElementById(id).classList.remove('active');
}

// Close modals on backdrop click
document.querySelectorAll('.modal-overlay').forEach(ov => {
    ov.addEventListener('click', e => {
        if (e.target === ov) ov.classList.remove('active');
    });
});

// â”€â”€ Wallet â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showWalletModal() {
    document.getElementById('walletModal').classList.add('active');
}

async function addWallet() {
    const address = document.getElementById('walletAddr').value;
    const chain = document.getElementById('walletChain').value;
    const label = document.getElementById('walletLabel').value;
    if (!address) return;
    try {
        await api('/api/wallet/add', {
            method: 'POST',
            body: JSON.stringify({ address, chain, label }),
        });
        closeModal('walletModal');
        loadProfile();
    } catch (e) {
        alert(e.message);
    }
}

async function removeWallet(addr, chain) {
    try {
        await api(`/api/wallet/${encodeURIComponent(addr)}?chain=${chain}`, { method: 'DELETE' });
        loadProfile();
    } catch (e) {
        alert(e.message);
    }
}

// â”€â”€ Bank Accounts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showBankModal() {
    document.getElementById('bankError').style.display = 'none';
    document.getElementById('bankSuccess').style.display = 'none';
    document.getElementById('bankFormFields').style.display = 'block';
    document.getElementById('bankStep1').className = 'verify-step active';
    document.getElementById('bankStep2').className = 'verify-step';
    document.getElementById('bankStep3').className = 'verify-step';
    ['bankHolder','bankAccNum','bankAccNumConfirm','bankIFSC','bankName'].forEach(id => document.getElementById(id).value = '');
    document.getElementById('bankModal').classList.add('active');
}

// Auto-detect bank from IFSC
document.addEventListener('DOMContentLoaded', () => {
    const ifscEl = document.getElementById('bankIFSC');
    if (ifscEl) {
        ifscEl.addEventListener('input', function() {
            const prefix = this.value.toUpperCase().substring(0, 4);
            const banks = {
                'SBIN':'State Bank of India','HDFC':'HDFC Bank','ICIC':'ICICI Bank',
                'UTIB':'Axis Bank','PUNB':'Punjab National Bank','CNRB':'Canara Bank',
                'UBIN':'Union Bank of India','BARB':'Bank of Baroda','KKBK':'Kotak Mahindra Bank',
                'YESB':'Yes Bank','INDB':'IndusInd Bank','FDRL':'Federal Bank',
                'IOBA':'Indian Overseas Bank','IDIB':'Indian Bank','BKID':'Bank of India',
            };
            if (banks[prefix]) document.getElementById('bankName').value = banks[prefix];
        });
    }
});

async function verifyAndAddBank() {
    const holder = document.getElementById('bankHolder').value.trim();
    const accNum = document.getElementById('bankAccNum').value.trim();
    const accConfirm = document.getElementById('bankAccNumConfirm').value.trim();
    const ifsc = document.getElementById('bankIFSC').value.trim().toUpperCase();
    const bankName = document.getElementById('bankName').value.trim();
    const errEl = document.getElementById('bankError');
    const successEl = document.getElementById('bankSuccess');
    errEl.style.display = 'none';
    successEl.style.display = 'none';

    // Client-side checks
    if (!holder || !accNum || !ifsc || !bankName) {
        errEl.textContent = 'All fields are required'; errEl.style.display = 'block'; return;
    }
    if (accNum !== accConfirm) {
        errEl.textContent = 'Account numbers do not match'; errEl.style.display = 'block'; return;
    }

    // Step 2: Verifying
    document.getElementById('bankStep1').className = 'verify-step done';
    document.getElementById('bankStep2').className = 'verify-step active';

    try {
        // Verify first
        const verifyResult = await api('/api/bank/verify', {
            method: 'POST',
            body: JSON.stringify({ account_holder: holder, account_number: accNum, ifsc_code: ifsc, bank_name: bankName }),
        });
        if (!verifyResult.verified) {
            document.getElementById('bankStep2').className = 'verify-step';
            document.getElementById('bankStep1').className = 'verify-step active';
            errEl.textContent = verifyResult.errors.join(', '); errEl.style.display = 'block'; return;
        }

        // Add the account
        const addResult = await api('/api/bank/add', {
            method: 'POST',
            body: JSON.stringify({ account_holder: holder, account_number: accNum, ifsc_code: ifsc, bank_name: bankName }),
        });

        document.getElementById('bankStep2').className = 'verify-step done';
        document.getElementById('bankStep3').className = 'verify-step done';
        document.getElementById('bankFormFields').style.display = 'none';
        successEl.innerHTML = `âœ… <strong>${addResult.bank_name}</strong> account ending in ****${addResult.last4} linked successfully!`;
        successEl.style.display = 'block';

        // Refresh profile after delay
        setTimeout(() => { closeModal('bankModal'); loadProfile(); }, 2000);
    } catch (e) {
        document.getElementById('bankStep2').className = 'verify-step';
        document.getElementById('bankStep1').className = 'verify-step active';
        errEl.textContent = e.message; errEl.style.display = 'block';
    }
}

async function removeBank(bankId) {
    if (!confirm('Remove this bank account?')) return;
    try {
        await api(`/api/bank/${bankId}`, { method: 'DELETE' });
        loadProfile();
    } catch (e) { alert(e.message); }
}

// â”€â”€ Deposit / Withdraw â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function populateBankSelect(selectId) {
    const sel = document.getElementById(selectId);
    const banks = (currentUser && currentUser.bank_accounts) || [];
    sel.innerHTML = banks.filter(b => b.verified)
        .map(b => `<option value="${b.id}">${b.bank_name} â€¢â€¢â€¢â€¢${b.account_last4}</option>`)
        .join('');
    return banks.filter(b => b.verified).length;
}

function showDepositModal() {
    document.getElementById('depositError').style.display = 'none';
    document.getElementById('depositSuccess').style.display = 'none';
    document.getElementById('depositAmount').value = '';
    const count = populateBankSelect('depositBank');
    document.getElementById('depositNoBanks').style.display = count === 0 ? 'block' : 'none';
    document.getElementById('depositFields').style.display = count > 0 ? 'block' : 'none';
    document.getElementById('depositModal').classList.add('active');
}

function showWithdrawModal() {
    document.getElementById('withdrawError').style.display = 'none';
    document.getElementById('withdrawSuccess').style.display = 'none';
    document.getElementById('withdrawAmount').value = '';
    document.getElementById('withdrawAvailable').textContent = formatINR(currentUser?.wallet_balance || 0);
    populateBankSelect('withdrawBank');
    document.getElementById('withdrawModal').classList.add('active');
}

function setDepositAmount(amt) {
    document.getElementById('depositAmount').value = amt;
}

function formatINR(n) {
    return Number(n).toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

async function submitDeposit() {
    const amount = parseFloat(document.getElementById('depositAmount').value);
    const bank_id = parseInt(document.getElementById('depositBank').value);
    const errEl = document.getElementById('depositError');
    const successEl = document.getElementById('depositSuccess');
    errEl.style.display = 'none'; successEl.style.display = 'none';

    if (!amount || amount <= 0) { errEl.textContent = 'Enter a valid amount'; errEl.style.display = 'block'; return; }

    try {
        const res = await api('/api/wallet/deposit', {
            method: 'POST',
            body: JSON.stringify({ amount, bank_id }),
        });
        successEl.innerHTML = `âœ… â‚¹${formatINR(amount)} deposited successfully! New balance: <strong>â‚¹${formatINR(res.new_balance)}</strong>`;
        successEl.style.display = 'block';
        document.getElementById('depositFields').style.display = 'none';
        // Update local state
        if (currentUser) currentUser.wallet_balance = res.new_balance;
        document.getElementById('walletBalanceDisplay').textContent = formatINR(res.new_balance);
        setTimeout(() => { closeModal('depositModal'); document.getElementById('depositFields').style.display = 'block'; }, 2500);
    } catch (e) {
        errEl.textContent = e.message; errEl.style.display = 'block';
    }
}

async function submitWithdraw() {
    const amount = parseFloat(document.getElementById('withdrawAmount').value);
    const bank_id = parseInt(document.getElementById('withdrawBank').value);
    const errEl = document.getElementById('withdrawError');
    const successEl = document.getElementById('withdrawSuccess');
    errEl.style.display = 'none'; successEl.style.display = 'none';

    if (!amount || amount <= 0) { errEl.textContent = 'Enter a valid amount'; errEl.style.display = 'block'; return; }

    try {
        const res = await api('/api/wallet/withdraw', {
            method: 'POST',
            body: JSON.stringify({ amount, bank_id }),
        });
        successEl.innerHTML = `âœ… â‚¹${formatINR(amount)} withdrawal initiated. New balance: <strong>â‚¹${formatINR(res.new_balance)}</strong>`;
        successEl.style.display = 'block';
        document.getElementById('withdrawFields').style.display = 'none';
        if (currentUser) currentUser.wallet_balance = res.new_balance;
        document.getElementById('walletBalanceDisplay').textContent = formatINR(res.new_balance);
        setTimeout(() => { closeModal('withdrawModal'); document.getElementById('withdrawFields').style.display = 'block'; }, 2500);
    } catch (e) {
        errEl.textContent = e.message; errEl.style.display = 'block';
    }
}

async function showTransactionsModal() {
    document.getElementById('transactionsModal').classList.add('active');
    const list = document.getElementById('transactionsList');
    list.innerHTML = '<div class="loader"><div class="spinner"></div></div>';
    try {
        const txns = await api('/api/wallet/transactions?limit=30');
        if (txns.length === 0) {
            list.innerHTML = '<div class="empty-state"><p>No transactions yet</p></div>';
            return;
        }
        list.innerHTML = txns.map(t => `
            <div class="txn-item">
                <div>
                    <span class="txn-type ${t.type === 'deposit' ? 'txn-deposit' : 'txn-withdraw'}">
                        ${t.type === 'deposit' ? 'â¬† Deposit' : 'â¬‡ Withdraw'}
                    </span>
                    <div style="font-size:12px;color:var(--text-muted);margin-top:4px">${t.description}</div>
                    <div style="font-size:11px;color:var(--text-muted)">${new Date(t.created_at).toLocaleString()}</div>
                </div>
                <div class="txn-amount" style="color:${t.type === 'deposit' ? '#00d4aa' : '#ff6b6b'}">
                    ${t.type === 'deposit' ? '+' : '-'}â‚¹${formatINR(t.amount)}
                </div>
            </div>
        `).join('');
    } catch (e) {
        list.innerHTML = `<div class="empty-state"><p>Error loading transactions</p></div>`;
    }
}

// â”€â”€ Portfolio â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showPortfolioModal() {
    document.getElementById('portfolioModal').classList.add('active');
}

async function addPortfolioItem() {
    const coin_id = document.getElementById('pfCoinId').value;
    const amount = parseFloat(document.getElementById('pfAmount').value);
    const avg_price = parseFloat(document.getElementById('pfPrice').value);
    if (!coin_id || isNaN(amount)) return;
    try {
        await api(`/api/portfolio?coin_id=${encodeURIComponent(coin_id)}&amount=${amount}&avg_price=${avg_price}`, {
            method: 'POST',
        });
        closeModal('portfolioModal');
        loadProfile();
    } catch (e) {
        alert(e.message);
    }
}

// â”€â”€ Profile â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadProfile() {
    if (!currentUser) return;
    document.getElementById('profileTitle').textContent = currentUser.username + "'s Profile";
    document.getElementById('profileEmail').textContent = currentUser.email;

    // Email verification banner
    let verifyBanner = document.getElementById('verifyBanner');
    if (!verifyBanner) {
        verifyBanner = document.createElement('div');
        verifyBanner.id = 'verifyBanner';
        document.getElementById('profileEmail').after(verifyBanner);
    }
    if (currentUser.email_verified) {
        verifyBanner.innerHTML = '<span style="color:#00d4aa;font-size:13px;">\u2705 Email verified</span>';
    } else {
        verifyBanner.innerHTML = '<div style="background:#2a1a00;border:1px solid #ff9900;border-radius:8px;padding:10px 16px;margin-top:8px;font-size:13px;color:#ffcc00;">'
            + '\u26A0\uFE0F Email not verified &mdash; <a href="#" style="color:#7c5cff;" onclick="resendVerification()">Resend verification email</a></div>';
    }

    // Wallet Balance
    document.getElementById('walletBalanceDisplay').textContent = formatINR(currentUser.wallet_balance || 0);

    // Bank Accounts
    const banks = currentUser.bank_accounts || [];
    const bl = document.getElementById('bankList');
    if (banks.length === 0) {
        bl.innerHTML = '<div class="empty-state" style="padding:20px"><p>No bank accounts linked yet</p><p style="font-size:12px;margin-top:4px">Link a bank account to add money to your wallet</p></div>';
    } else {
        bl.innerHTML = banks.map(b => `
            <div class="bank-card">
                <div class="bank-info">
                    <div class="bank-icon">${b.bank_name.charAt(0)}</div>
                    <div>
                        <div class="bank-name">${b.bank_name}</div>
                        <div class="bank-detail">${b.account_holder} &bull; ****${b.account_last4} &bull; ${b.ifsc_code}</div>
                        <span class="bank-verified">${b.verified ? '\u2705 Verified' : '\u23f3 Pending'}</span>
                    </div>
                </div>
                <button class="btn btn-sm btn-danger" onclick="removeBank(${b.id})">Remove</button>
            </div>
        `).join('');
    }

    // Wallets
    const wallets = currentUser.wallets || [];
    const wl = document.getElementById('walletList');
    if (wallets.length === 0) {
        wl.innerHTML = '<div class="empty-state"><p>No wallets connected yet</p></div>';
    } else {
        wl.innerHTML = wallets.map(w => `
            <div class="wallet-card">
                <div>
                    <span class="wallet-addr">${w.address}</span>
                    <span class="wallet-chain">${w.chain}</span>
                    ${w.label ? '<span style="color:var(--text-muted);font-size:12px;margin-left:8px">' + w.label + '</span>' : ''}
                </div>
                <button class="btn btn-sm btn-danger" onclick="removeWallet('${w.address}','${w.chain}')">Remove</button>
            </div>
        `).join('');
    }

    // Portfolio
    try {
        const portfolio = await api('/api/portfolio');
        const pb = document.getElementById('portfolioBody');
        if (portfolio.length === 0) {
            pb.innerHTML = '<tr><td colspan="5" style="text-align:center;color:var(--text-muted);padding:20px">No positions yet</td></tr>';
        } else {
            pb.innerHTML = portfolio.map(p => `
                <tr>
                    <td style="font-weight:600">${p.coin_id.toUpperCase()}</td>
                    <td>${p.amount}</td>
                    <td>${fmt(p.avg_buy_price)}</td>
                    <td>${fmt(p.current_price)}</td>
                    <td class="${p.pnl >= 0 ? 'price-positive' : 'price-negative'}">${p.pnl >= 0 ? '+' : ''}${fmt(p.pnl)} (${p.pnl_pct.toFixed(1)}%)</td>
                </tr>
            `).join('');
        }
    } catch (e) {
        console.error('Portfolio error:', e);
    }

    // Watchlist
    const wlArea = document.getElementById('watchlistArea');
    const wlist = currentUser.watchlist || [];
    if (wlist.length === 0) {
        wlArea.innerHTML = '<div class="empty-state"><p>Watchlist empty â€” click â˜… on any token to add</p></div>';
    } else {
        wlArea.innerHTML = wlist.map(c => `
            <span class="filter-pill" style="cursor:pointer" onclick="openToken('${c}','${c}')">${c}</span>
        `).join(' ');
    }
}

// â”€â”€ Home Data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadHomeData() {
    try {
        const [coins, trending] = await Promise.all([
            api('/api/market/top?limit=10'),
            api('/api/market/trending'),
        ]);

        // Trending bar
        const bar = document.getElementById('trendingBar');
        bar.innerHTML = trending.map(t => `
            <div class="filter-pill" style="cursor:pointer" onclick="openToken('${t.coin_id}','${t.name}')">
                ğŸ”¥ ${t.name} <span style="color:var(--text-muted)">${t.symbol}</span>
            </div>
        `).join('');

        // Market table
        const body = document.getElementById('homeMarketBody');
        body.innerHTML = coins.map(c => `
            <tr style="cursor:pointer" onclick="openToken('${c.coin_id}','${c.name}')">
                <td>${c.rank || '-'}</td>
                <td>
                    <div class="token-info">
                        <div class="token-icon">${c.symbol.slice(0,2)}</div>
                        <div><div class="token-name">${c.name}</div><div class="token-symbol">${c.symbol}</div></div>
                    </div>
                </td>
                <td>${fmt(c.price)}</td>
                <td>${fmtPct(c.price_change_24h)}</td>
                <td>${fmt(c.market_cap)}</td>
                <td>${fmt(c.volume_24h)}</td>
            </tr>
        `).join('');
    } catch (e) {
        console.error('Home data error:', e);
    }
}

// â”€â”€ Token Feed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function setFeedSort(el) {
    document.querySelectorAll('[data-sort]').forEach(p => p.classList.remove('active'));
    el.classList.add('active');
    feedSort = el.dataset.sort;
    loadFeed();
}

function setFeedStatus(el) {
    document.querySelectorAll('[data-status]').forEach(p => p.classList.remove('active'));
    el.classList.add('active');
    feedStatus = el.dataset.status;
    loadFeed();
}

async function loadFeed() {
    const body = document.getElementById('feedBody');
    body.innerHTML = '<tr><td colspan="7"><div class="loader"><div class="spinner"></div></div></td></tr>';

    try {
        feedData = await api(`/api/feed/tokens?sort=${feedSort}&status=${feedStatus}&limit=50`);
        document.getElementById('feedCount').textContent = `${feedData.length} tokens on DexScreener`;
        renderFeed(feedData);
    } catch (e) {
        body.innerHTML = `<tr><td colspan="7" class="empty-state">${e.message}</td></tr>`;
    }
}

function renderFeed(data) {
    const body = document.getElementById('feedBody');
    body.innerHTML = data.map(t => `
        <tr style="cursor:pointer" onclick="window.open('https://dexscreener.com/solana/${t.address}','_blank')">
            <td>
                <div class="token-info">
                    <div class="token-icon">${t.symbol.slice(0,2)}</div>
                    <div>
                        <div class="token-name">${t.name}</div>
                        <div class="token-symbol">$${t.symbol}</div>
                    </div>
                </div>
            </td>
            <td>${fmt(t.price)}</td>
            <td>${fmtPct(t.price_change_24h)}</td>
            <td>${fmt(t.volume_24h)}</td>
            <td>${fmt(t.liquidity)}</td>
            <td>${t.trades_count}</td>
            <td style="color:var(--text-muted)">${t.age || '-'}</td>
        </tr>
    `).join('');
}

function filterFeedLocal(q) {
    if (!q) return renderFeed(feedData);
    const f = feedData.filter(t => t.name.toLowerCase().includes(q.toLowerCase()) || t.symbol.toLowerCase().includes(q.toLowerCase()));
    renderFeed(f);
}

// â”€â”€ AI Recommendations â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadAIGlobal() {
    try {
        const coins = await api('/api/market/top?limit=3');
        const txt = coins.map(c => `${c.name}: ${fmt(c.price)} (${c.price_change_24h >= 0 ? '+' : ''}${c.price_change_24h.toFixed(2)}%)`).join(' | ');
        document.getElementById('aiMarketGlobal').textContent = txt;
    } catch {
        document.getElementById('aiMarketGlobal').innerHTML = '<span style="color:var(--red)">Failed to load market data.</span>';
    }
}

function toggleSwitch(el) {
    el.classList.toggle('off');
}

async function loadAIRecs() {
    const onchain = !document.getElementById('toggleOnchain').classList.contains('off');
    const technical = !document.getElementById('toggleTechnical').classList.contains('off');
    const cards = document.getElementById('aiCards');
    cards.innerHTML = '<div class="loader"><div class="spinner"></div></div>';
    document.getElementById('aiSummaryBox').style.display = 'none';

    try {
        const data = await api(`/api/ai/recommendations?enable_onchain=${onchain}&enable_technical=${technical}`);

        document.getElementById('aiTimestamp').textContent = `Results from ${new Date(data.timestamp).toLocaleString()}`;
        document.getElementById('aiSummaryText').textContent = data.market_summary;
        document.getElementById('aiSummaryBox').style.display = 'block';

        cards.innerHTML = data.tokens.map(t => {
            const sColor = t.score >= 70 ? 'score-green' : (t.score >= 40 ? 'score-yellow' : 'score-red');
            const vClass = 'verdict-' + t.verdict.replace(' ', '_');

            let barsHtml = '';
            if (t.on_chain && Object.keys(t.on_chain).length) {
                barsHtml = '<div class="on-chain-bars">';
                for (const [k, v] of Object.entries(t.on_chain)) {
                    const pct = Math.min(100, (v / 25) * 100);
                    barsHtml += `
                        <div class="bar-row">
                            <div class="bar-label">${k.replace(/_/g,' ')}</div>
                            <div class="bar-track"><div class="bar-fill" style="width:${pct}%"></div></div>
                        </div>`;
                }
                barsHtml += '</div>';
            }

            return `
                <div class="score-card">
                    <div class="score-circle ${sColor}">${t.score}</div>
                    <div class="score-card-name">${t.name}</div>
                    <div class="score-card-sym">$${t.symbol}</div>
                    <div class="score-card-summary">${t.summary}</div>
                    <span class="verdict-badge ${vClass}">${t.verdict}</span>
                    ${t.risk_flags.length ? '<div style="margin-top:8px;font-size:12px;color:var(--red)">âš  ' + t.risk_flags.join(', ') + '</div>' : ''}
                    ${barsHtml}
                </div>
            `;
        }).join('');
    } catch (e) {
        cards.innerHTML = `<div class="empty-state"><h3>Error</h3><p>${e.message}</p></div>`;
    }
}

// â”€â”€ Leaderboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadLeaderboard() {
    const body = document.getElementById('lbBody');
    body.innerHTML = '<tr><td colspan="7"><div class="loader"><div class="spinner"></div></div></td></tr>';

    try {
        const entries = await api('/api/leaderboard?limit=25');
        body.innerHTML = entries.map(e => `
            <tr>
                <td>${e.rank}</td>
                <td class="trader-addr">${e.trader}</td>
                <td class="${e.pnl >= 0 ? 'price-positive' : 'price-negative'}" style="font-weight:600">
                    ${e.pnl >= 0 ? '+' : ''}${fmt(e.pnl)}
                </td>
                <td>${fmt(e.spent)}</td>
                <td>${fmt(e.received)}</td>
                <td>${e.trades}</td>
                <td>${e.win_rate}%</td>
            </tr>
        `).join('');
    } catch (e) {
        body.innerHTML = `<tr><td colspan="7" class="empty-state">${e.message}</td></tr>`;
    }
}

// â”€â”€ Market Page â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadMarket() {
    const body = document.getElementById('marketBody');
    body.innerHTML = '<tr><td colspan="6"><div class="loader"><div class="spinner"></div></div></td></tr>';

    try {
        const [coins, trending] = await Promise.all([
            api('/api/market/top?limit=50'),
            api('/api/market/trending'),
        ]);

        // Trending
        document.getElementById('trendingMarket').innerHTML = trending.map(t => `
            <div class="filter-pill" style="cursor:pointer" onclick="openToken('${t.coin_id}','${t.name}')">
                ğŸ”¥ ${t.name}
            </div>
        `).join('');

        body.innerHTML = coins.map(c => `
            <tr style="cursor:pointer" onclick="openToken('${c.coin_id}','${c.name}')">
                <td>${c.rank || '-'}</td>
                <td>
                    <div class="token-info">
                        <div class="token-icon">${c.symbol.slice(0,2)}</div>
                        <div><div class="token-name">${c.name}</div><div class="token-symbol">${c.symbol}</div></div>
                    </div>
                </td>
                <td>${fmt(c.price)}</td>
                <td>${fmtPct(c.price_change_24h)}</td>
                <td>${fmt(c.market_cap)}</td>
                <td>${fmt(c.volume_24h)}</td>
            </tr>
        `).join('');
    } catch (e) {
        body.innerHTML = `<tr><td colspan="6" class="empty-state">${e.message}</td></tr>`;
    }
}

// â”€â”€ Token Detail â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function openToken(coinId, name) {
    const modal = document.getElementById('detailModal');
    const content = document.getElementById('detailContent');
    modal.classList.add('active');
    content.innerHTML = '<div class="loader"><div class="spinner"></div></div>';

    try {
        const d = await api('/api/token/' + encodeURIComponent(coinId));
        const chgCls = d.price_change_24h >= 0 ? 'price-positive' : 'price-negative';

        let html = `
        <div class="detail-header">
            <div class="detail-avatar">${d.symbol.slice(0,2)}</div>
            <div>
                <div class="detail-name">${d.name}</div>
                <div class="detail-symbol">${d.symbol}${d.rank ? ' Â· Rank #' + d.rank : ''}</div>
            </div>
            ${currentUser ? '<button class="btn btn-sm btn-outline" style="margin-left:auto" onclick="addWatchlist(\'' + coinId + '\')">â˜… Watch</button>' : ''}
        </div>

        <div class="detail-price-row">
            <span class="detail-price">${fmt(d.price)}</span>
            <span class="${chgCls}" style="font-size:18px;font-weight:600">
                ${d.price_change_24h >= 0 ? 'â–²' : 'â–¼'} ${Math.abs(d.price_change_24h).toFixed(2)}% (24h)
            </span>
        </div>

        <div class="metrics-grid">
            <div class="metric-box"><div class="metric-label">Market Cap</div><div class="metric-value">${fmt(d.market_cap)}</div></div>
            <div class="metric-box"><div class="metric-label">Volume 24h</div><div class="metric-value">${fmt(d.volume_24h)}</div></div>
            <div class="metric-box"><div class="metric-label">All-Time High</div><div class="metric-value">${fmt(d.ath)}</div></div>
        </div>`;

        // TA
        if (d.ta_trend && d.ta_trend !== 'unknown') {
            const taColor = scoreColor(d.ta_score);
            html += `
            <div class="analysis-section">
                <div class="analysis-title">ğŸ“Š Technical Analysis</div>
                <div class="analysis-row"><span>Score</span><span>${d.ta_score.toFixed(1)} / 10</span></div>
                <div class="score-bar-container"><div class="score-bar ${taColor}" style="width:${d.ta_score*10}%"></div></div>
                <div class="analysis-row" style="margin-top:10px"><span>Trend</span><span>${d.ta_trend}</span></div>
                <div class="analysis-row"><span>RSI (14)</span><span>${d.ta_rsi.toFixed(1)} (${d.ta_rsi_label})</span></div>
                <div class="analysis-row"><span>MACD</span><span>${d.ta_macd}</span></div>
                <div class="analysis-row"><span>Pattern</span><span>${d.ta_pattern || 'None'}</span></div>
                <div class="analysis-row"><span>Support</span><span>${fmt(d.ta_support)}</span></div>
                <div class="analysis-row"><span>Resistance</span><span>${fmt(d.ta_resistance)}</span></div>
            </div>`;
        }

        // News
        const newsColor = scoreColor(d.news_score);
        html += `
        <div class="analysis-section">
            <div class="analysis-title">ğŸ“° News & Sentiment</div>
            <div class="analysis-row"><span>Score</span><span>${d.news_score.toFixed(1)} / 10</span></div>
            <div class="score-bar-container"><div class="score-bar ${newsColor}" style="width:${d.news_score*10}%"></div></div>
            <div class="analysis-row" style="margin-top:10px"><span>Narrative</span><span>${d.news_narrative || 'Neutral'}</span></div>
        </div>`;

        if (d.news_headlines?.length) {
            html += '<div class="analysis-section"><div class="analysis-title">ğŸ“Œ Headlines</div>';
            d.news_headlines.forEach(h => {
                html += `<div style="font-size:13px;color:var(--text-secondary);padding:4px 0;border-bottom:1px solid var(--border)">â€¢ ${h}</div>`;
            });
            html += '</div>';
        }

        // AI
        if (d.ai_available && d.ai_recommendation) {
            html += `
            <div class="ai-box">
                <div class="ai-box-title">ğŸ¤– AI Recommendation <span class="ai-badge">GEMINI</span></div>
                <div class="ai-text">${d.ai_recommendation}</div>
            </div>`;
        } else {
            html += `
            <div class="ai-box" style="opacity:0.6">
                <div class="ai-box-title">ğŸ¤– AI Recommendation <span class="ai-badge" style="background:var(--text-muted)">OFFLINE</span></div>
                <div class="ai-text">AI analysis unavailable. Set a GEMINI_API_KEY with quota to enable.</div>
            </div>`;
        }

        content.innerHTML = html;
    } catch (e) {
        content.innerHTML = `<div class="empty-state"><h3>Error loading token</h3><p>${e.message}</p></div>`;
    }
}

async function addWatchlist(coinId) {
    if (!currentUser) return showAuthModal('login');
    try {
        const data = await api(`/api/watchlist/${coinId}`, { method: 'POST' });
        currentUser.watchlist = data.watchlist;
        alert('Added to watchlist!');
    } catch (e) {
        alert(e.message);
    }
}

// â”€â”€ Search â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function doSearch() {
    const q = document.getElementById('globalSearch').value.trim();
    if (!q) return;

    // Try to open as CoinGecko token first
    navigate('market');
    openToken(q.toLowerCase(), q);
}

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
checkAuth();
loadHomeData();

// Keyboard shortcut
document.addEventListener('keydown', e => {
    if (e.key === '/' && document.activeElement.tagName !== 'INPUT') {
        e.preventDefault();
        document.getElementById('globalSearch').focus();
    }
    if (e.key === 'Escape') {
        document.querySelectorAll('.modal-overlay.active').forEach(m => m.classList.remove('active'));
    }
});
</script>
</body>
</html>
