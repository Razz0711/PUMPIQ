# render.yaml — Render Blueprint for NexYpher Backend
# https://render.com/docs/blueprint-spec
#
# Deploy: Connect your GitHub repo on Render Dashboard,
#         or use `render blueprint launch` CLI.

services:
  - type: web
    name: nexypher-api
    runtime: python
    region: oregon
    plan: free
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn web_app:app --host 0.0.0.0 --port $PORT
    envVars:
      # ── Database (Supabase) ──
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_KEY
        sync: false

      # ── AI API Keys ──
      - key: GEMINI_API_KEY
        sync: false
      - key: GEMINI_MODEL
        value: "gemini-2.0-flash"
      - key: OPENAI_API_KEY
        sync: false
      - key: OPENAI_MODEL
        value: "gpt-4o"

      # ── Data Source API Keys ──
      - key: COINGECKO_API_KEY
        sync: false
      - key: APIFY_API_KEY
        sync: false
      - key: SOLANA_RPC_URL
        value: "https://api.mainnet-beta.solana.com"
      - key: NEWS_API_KEY
        sync: false
      - key: CRYPTOPANIC_API_KEY
        sync: false

      # ── Security Settings ──
      - key: SECRET_KEY
        sync: false
      - key: ALGORITHM
        value: "HS256"
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: "60"

      # ── API / CORS ──
      - key: CORS_ORIGINS
        value: "https://nexypher.vercel.app,http://localhost:3000,http://localhost:8000"

      # ── Environment ──
      - key: ENVIRONMENT
        value: "production"
      - key: LOG_LEVEL
        value: "INFO"

      # ── SMTP (Gmail) ──
      - key: SMTP_HOST
        value: "smtp.gmail.com"
      - key: SMTP_PORT
        value: "587"
      - key: SMTP_EMAIL
        sync: false
      - key: SMTP_PASSWORD
        sync: false
      - key: SMTP_USE_TLS
        value: "true"
      - key: SMTP_FROM_NAME
        value: "NexYpher"
      - key: APP_BASE_URL
        sync: false

      # ── Blockchain (Base L2) ──
      - key: BLOCKCHAIN_NETWORK
        value: "base_sepolia"
      - key: BASE_SEPOLIA_RPC
        value: "https://sepolia.base.org"
      - key: BASE_MAINNET_RPC
        value: "https://mainnet.base.org"
      - key: ETHEREUM_RPC
        value: "https://eth.llamarpc.com"
      - key: DEPLOYER_PRIVATE_KEY
        sync: false
      - key: CONTRACT_ADDRESS
        sync: false

      # ── Python Version ──
      - key: PYTHON_VERSION
        value: "3.11.6"
